<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        canvas {
            border: 1px solid black;
        }
    </style>
</head>
<body>
    <canvas id="gameCanvas" width="800" height="600"></canvas>
    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');

        const centerX = canvas.width / 2;
        const centerY = canvas.height / 2;

        const speed = 4; // Fixed speed for all balls

        function getRandomDirection() {
            const angle = Math.random() * 2 * Math.PI;
            return { dx: Math.cos(angle) * speed, dy: Math.sin(angle) * speed };
        }

        let x1 = centerX;
        let y1 = centerY;
        let { dx: dx1, dy: dy1 } = getRandomDirection();

        let x2 = centerX;
        let y2 = centerY;
        let { dx: dx2, dy: dy2 } = getRandomDirection();

        let x3 = centerX;
        let y3 = centerY;
        let { dx: dx3, dy: dy3 } = getRandomDirection();

        let x4 = centerX;
        let y4 = centerY;
        let { dx: dx4, dy: dy4 } = getRandomDirection();

        let ballRadius1 = 60;
        let ballRadius2 = 60;
        let ballRadius3 = 60;
        let ballRadius4 = 60;

        const spikeCount = 10;
        const spikes = [];

        for (let i = 0; i < spikeCount; i++) {
            spikes.push({
                x: Math.random() * (canvas.width - 20) + 10,
                y: Math.random() * (canvas.height - 20) + 10,
                size: 10
            });
        }

        function drawBall(x, y, radius, color) {
            ctx.beginPath();
            ctx.arc(x, y, radius, 0, Math.PI * 2);
            ctx.fillStyle = color;
            ctx.fill();
            ctx.closePath();
        }

        function drawSpike(x, y, size) {
            ctx.beginPath();
            ctx.moveTo(x, y - size);
            ctx.lineTo(x - size, y + size);
            ctx.lineTo(x + size, y + size);
            ctx.closePath();
            ctx.fillStyle = 'black';
            ctx.fill();
        }

        function draw() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            drawBall(x1, y1, ballRadius1, "#0095DD");
            drawBall(x2, y2, ballRadius2, "#FF0000");
            drawBall(x3, y3, ballRadius3, "#00FF00");
            drawBall(x4, y4, ballRadius4, "#FFFF00");

            spikes.forEach(spike => {
                drawSpike(spike.x, spike.y, spike.size);
            });

            if (x1 + dx1 > canvas.width - ballRadius1 || x1 + dx1 < ballRadius1) {
                dx1 = -dx1;
            }
            if (y1 + dy1 > canvas.height - ballRadius1 || y1 + dy1 < ballRadius1) {
                dy1 = -dy1;
            }
            x1 += dx1;
            y1 += dy1;

            if (x2 + dx2 > canvas.width - ballRadius2 || x2 + dx2 < ballRadius2) {
                dx2 = -dx2;
            }
            if (y2 + dy2 > canvas.height - ballRadius2 || y2 + dy2 < ballRadius2) {
                dy2 = -dy2;
            }
            x2 += dx2;
            y2 += dy2;

            if (x3 + dx3 > canvas.width - ballRadius3 || x3 + dx3 < ballRadius3) {
                dx3 = -dx3;
            }
            if (y3 + dy3 > canvas.height - ballRadius3 || y3 + dy3 < ballRadius3) {
                dy3 = -dy3;
            }
            x3 += dx3;
            y3 += dy3;

            if (x4 + dx4 > canvas.width - ballRadius4 || x4 + dx4 < ballRadius4) {
                dx4 = -dx4;
            }
            if (y4 + dy4 > canvas.height - ballRadius4 || y4 + dy4 < ballRadius4) {
                dy4 = -dy4;
            }
            x4 += dx4;
            y4 += dy4;

            const balls = [
                { x: x1, y: y1, radius: ballRadius1, updateRadius: (newRadius) => ballRadius1 = newRadius },
                { x: x2, y: y2, radius: ballRadius2, updateRadius: (newRadius) => ballRadius2 = newRadius },
                { x: x3, y: y3, radius: ballRadius3, updateRadius: (newRadius) => ballRadius3 = newRadius },
                { x: x4, y: y4, radius: ballRadius4, updateRadius: (newRadius) => ballRadius4 = newRadius }
            ];

            const activeBalls = balls.filter(ball => ball.radius > 0);

            if (activeBalls.length > 1) {
                activeBalls.forEach(ball => {
                    checkCollision(ball.x, ball.y, ball.radius, ball.updateRadius);
                });
            }
        }

        function checkCollision(x, y, radius, updateRadius) {
            spikes.forEach(spike => {
                const distX = Math.abs(x - spike.x);
                const distY = Math.abs(y - spike.y);
                if (distX < radius + spike.size && distY < radius + spike.size) {
                    updateRadius(radius - 1);
                }
            });
        }

        setInterval(draw, 10);
    </script>
</body>
</html>
